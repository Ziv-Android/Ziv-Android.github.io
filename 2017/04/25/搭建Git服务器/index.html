<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Summary knowledge to share."><title>搭建Git服务器 | Ziv‘s blog</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"></head><body><!-- gallery that comes before the header--><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a></nav><div class="container post-meta"><div class="post-time">2017-04-25</div></div></div><div class="container post-header"><h1>搭建Git服务器</h1></div><div class="container post-content"><h2 id="什么是Git"><a href="#什么是Git" class="headerlink" title="什么是Git"></a>什么是Git</h2><p>Git是一款免费、开源的分布式版本控制系统，用于敏捷高效的进行项目管理。<br>以CentOS 7.2 x64为例，一步步搭建git服务器</p>
<h2 id="安装依赖库和编译工具"><a href="#安装依赖库和编译工具" class="headerlink" title="安装依赖库和编译工具"></a>安装依赖库和编译工具</h2><p>依赖库<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel</div></pre></td></tr></table></figure></p>
<p>编译工具<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum install gcc perl-ExtUtils-MakeMaker</div></pre></td></tr></table></figure></p>
<h2 id="下载git"><a href="#下载git" class="headerlink" title="下载git"></a>下载git</h2><p>官网查看一个新版稳定的源码包下载 <a href="https://www.kernel.org/pub/software/scm/git/" target="_blank" rel="external">https://www.kernel.org/pub/software/scm/git/</a><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /usr/local/src</div><div class="line">wget https://www.kernel.org/pub/software/scm/git/git-2.14.1.tar.gz</div></pre></td></tr></table></figure></p>
<h2 id="解压编译和安装"><a href="#解压编译和安装" class="headerlink" title="解压编译和安装"></a>解压编译和安装</h2><p>解压<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar -zvxf git-2.14.1.tar.gz</div></pre></td></tr></table></figure></p>
<p>编译<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd git-2.14.1</div><div class="line">make all prefix=/usr/local/git</div></pre></td></tr></table></figure></p>
<p>安装到 /usr/local/git 目录下<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">make install prefix=/usr/local/git</div></pre></td></tr></table></figure></p>
<h2 id="配置PATH环境变量"><a href="#配置PATH环境变量" class="headerlink" title="配置PATH环境变量"></a>配置PATH环境变量</h2><p>将git安装目录配置在PATH环境变量中<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo 'export PATH=$PATH:/usr/local/git/bin' &gt;&gt; /etc/bashrc</div><div class="line">source /etc/bashrc</div></pre></td></tr></table></figure></p>
<p>测试是否配置成功<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git --version</div></pre></td></tr></table></figure></p>
<p>至此git服务器的搭建已经完成，接下来创建一个git账号测试一下</p>
<h2 id="测试git"><a href="#测试git" class="headerlink" title="测试git"></a>测试git</h2><h3 id="创建git账号密码"><a href="#创建git账号密码" class="headerlink" title="创建git账号密码"></a>创建git账号密码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">useradd -m username</div><div class="line">passwd username</div></pre></td></tr></table></figure>
<blockquote>
<p>密码长度8位，不能为简单的数字</p>
</blockquote>
<h3 id="初始化git仓库"><a href="#初始化git仓库" class="headerlink" title="初始化git仓库"></a>初始化git仓库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir -p /data/repositories</div><div class="line">cd /data/repositories/</div><div class="line">git init --bare test.git</div></pre></td></tr></table></figure>
<h3 id="配置用户权限"><a href="#配置用户权限" class="headerlink" title="配置用户权限"></a>配置用户权限</h3><p>设置git仓库用户和用户组并设置权限<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chown -R username:username /data/repositories</div><div class="line">chmod 755 /data/repositories</div></pre></td></tr></table></figure></p>
<p>编辑/ect/passwd文件，将username的登陆shell配置修改为git-shell目录<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">vim /etc/passwd</div><div class="line">username:x:500:500::/home/username:/usr/local/git/bin/git-shell</div></pre></td></tr></table></figure></p>
<blockquote>
<p>出于安全目的，限制 git 账号的 ssh 连接只能是登录 git-shell<br>使用 which git-shell 命令查看本机 git-shell 路径</p>
</blockquote>
<h3 id="使用git-clone服务"><a href="#使用git-clone服务" class="headerlink" title="使用git clone服务"></a>使用git clone服务</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd ~</div><div class="line">git clone username@&lt;服务器IP&gt;:/data/repositories/test.git</div><div class="line">···</div></pre></td></tr></table></figure></div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>